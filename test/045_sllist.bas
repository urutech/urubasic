10 REM SINGLY-LINKED LIST
20 LET L1=100
30 DIM A(99,2)
40 GOSUB 600
50 REM INSERT SOME ELEMENTS
60 LET H1=-1
70 READ N
80 FOR I=1 TO N
90 READ T
100 GOSUB 710
110 NEXT I
120 REM SHOW THE LIST ( 8, 6, 7, 5, 3, 0, 9 )
130 GOSUB 860
140 REM TEST SEARCHING FOR EXISTING
150 RESTORE
160 READ N
170 FOR I=1 TO N
180 READ T
190 GOSUB 970
200 IF F2=-1 THEN 230
210 PRINT T;"FOUND IN SLOT";F2;"-->";A(F2,0)
220 GOTO 240
230 PRINT T;"UNEXPECTEDLY NOT FOUND!"
240 NEXT I
250 REM TEST FOR SEARCHING NON-EXISTING
260 READ N
270 FOR I=1 TO N
280 READ T
290 GOSUB 970
300 IF F2=-1 THEN 330
310 PRINT T;"UNEXPECTEDLY FOUND IN SLOT";F2;"-->";A(F2,0)
320 GOTO 340
330 PRINT T;"NOT FOUND AS EXPECTED"
340 NEXT I
350 REM TEST DELETE HEAD NON-EMPTY LIST -> ( 6, 7, 5, 3, 0, 9 )
360 LET T=A(H1,0)
370 GOSUB 1060
380 GOSUB 860
390 REM TEST DELETE TAIL NON-EMPTY LIST -> ( 6, 7, 5, 3, 0 )
400 LET T=A(T1,0)
410 GOSUB 1060
420 GOSUB 860
430 REM TEST DELETE 3RD -> ( 6, 7, 3, 0 )
440 LET T=A(A(A(H1,1),1),0)
450 GOSUB 1060
460 GOSUB 860
470 REM APPEND ONE MORE
480 LET T=99
490 GOSUB 710
500 GOSUB 860
510 REM DELETE THE REST
520 IF H1=-1 THEN 580
530 LET T=A(H1,0)
540 GOSUB 1060
550 GOSUB 860
560 GOTO 520
570 PRINT "LAST LIST SHOULD HAVE BEEN EMPTY"
580 GOSUB 1350
590 STOP
600 REM *** INITIALIZE HEAP OF L1 ELEMENTS IN A() ***
610 REM NIL IS -1, FREE LIST POINTER IS F1
620 FOR I=0 TO 98
630 LET A(I,1)=I+1
640 LET A(I,0)=0
650 NEXT I
660 LET A(99,1)=-1
670 LET A(99,0)=0
680 LET F1=0
690 LET T1=-1
700 RETURN
710 REM *** APPEND AN ELEMENT T TO LIST WITH HEAD H1, TAIL T1 ***
720 IF F1<>-1 THEN 750
730 PRINT "HEAP EXHAUSTED"
740 STOP
750 LET T2=F1
760 LET F1=A(F1,1)
770 LET A(T2,0)=T
780 LET A(T2,1)=-1
790 IF T1<>-1 THEN 830
800 LET H1=T2
810 LET T1=T2
820 GOTO 840
830 LET A(T1,1)=T2
840 LET T1=T2
850 RETURN
860 REM *** DUMP LIST WITH HEAD H1 ***
870 PRINT "(";
880 IF H1=-1 THEN 950
890 LET T2=H1
900 PRINT A(T2,0);
910 LET T2=A(T2,1)
920 IF T2=-1 THEN 950
930 PRINT ",";
940 GOTO 900
950 PRINT ")"
960 RETURN
970 REM *** SEQUENTIAL SEARCH LIST WITH HEAD H1 FOR T ***
980 REM F2=-1 NOT FOUND, F2=INDEX IF FOUND
990 LET F2=-1
1000 LET F2=H1
1010 IF F2=-1 THEN 1050
1020 IF A(F2,0)=T THEN 1050
1030 LET F2=A(F2,1)
1040 GOTO 1010
1050 RETURN
1060 REM *** DELETE T FROM LIST WITH HEAD H1 ***
1070 REM RETURN F2=-1 FOR FAIL, F2=1 FOR SUCCESS
1080 LET F2=-1
1090 REM IS IT EMPTY LIST?
1100 IF H1=-1 THEN 1340
1110 REM IS IT HEAD?
1120 IF A(H1,0)<>T THEN 1200
1130 LET T2=A(H1,1)
1140 LET A(H1,1)=F1
1150 LET F1=H1
1160 LET H1=T2
1170 IF T1<>F1 THEN 1190
1180 LET T1=-1
1190 GOTO 1330
1200 LET T2=H1
1210 LET T3=A(H1,1)
1220 IF T3=-1 THEN 1340
1230 IF A(T3,0)=T THEN 1270
1240 LET T2=T3
1250 LET T3=A(T3,1)
1260 GOTO 1220
1270 REM FOUND IT AND IT IS NOT HEAD
1280 LET A(T2,1)=A(T3,1)
1290 IF A(T2,1)<>-1 THEN 1310
1300 LET T1=T2
1310 LET A(T3,1)=F1
1320 LET F1=T3
1330 LET F2=1
1340 RETURN
1350 REM *** DUMP HEAP ***
1360 PRINT "F1=";F1,"H1=";H1,"T1=";T1
1370 FOR I=0 TO 99
1380 PRINT "A(";I;",0)=";A(I,0),"A(";I;",1)=";A(I,1)
1390 NEXT I
1400 RETURN
1410 DATA 7,8,6,7,5,3,0,9
1420 DATA 4,1,2,4,10
1430 END

